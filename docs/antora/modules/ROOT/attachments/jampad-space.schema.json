{
  "$schema": "http://json-schema.org/draft-06/schema#",
  "$id": "https://jampad.app/schemas/jampad-space.schema.json",
  "title": "Jam Pad Space Export",
  "description": "The format in which Jam Pad exports a single space",
  "$ref": "#/definitions/Space",
  "definitions": {
    "Space": {
      "type": "object",
      "required": [],
      "additionalProperties": false,
      "title": "Space",
      "description": "All contents of a single Jam Pad space that are not user/device-specific",
      "properties": {
        "$schema": {
          "type": "string",
          "description": "URL pointing to this schema (as a hint for editors)"
        },
        "customFieldsForClips": {
          "type": "array",
          "description": "All custom fields usable for clips",
          "items": {
            "$ref": "#/definitions/CustomField"
          }
        },
        "customFieldsForMarkers": {
          "type": "array",
          "description": "All custom fields usable for markers",
          "items": {
            "$ref": "#/definitions/CustomField"
          }
        },
        "customItemTypes": {
          "description": "All types of custom items usable for custom fields",
          "type": "array",
          "items": {
            "$ref": "#/definitions/CustomItemType"
          }
        },
        "customItems": {
          "description": "All custom items usable for custom fields. Each map key must be the ID of a custom item type. Each value must be the list of custom items.",
          "type": "object",
          "additionalProperties": {
            "type": "array",
            "items": {
              "$ref": "#/definitions/CustomItem"
            }
          }
        },
        "clips": {
          "description": "All clips",
          "type": "array",
          "items": {
            "$ref": "#/definitions/Clip"
          }
        },
        "markers": {
          "description": "All markers",
          "type": "array",
          "items": {
            "$ref": "#/definitions/Marker"
          }
        },
        "playlists": {
          "description": "All playlists",
          "type": "array",
          "items": {
            "$ref": "#/definitions/Playlist"
          }
        },
        "sheets": {
          "description": "All sheets",
          "type": "array",
          "items": {
            "$ref": "#/definitions/Sheet"
          }
        }
      }
    },
    "CustomField": {
      "type": "object",
      "required": ["id", "name", "type"],
      "title": "Custom field",
      "description": "A custom field usable for clips or markers, depending in which list it appears",
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string",
          "description": "Identifier of the custom field. Must be unique within this space."
        },
        "hidden": {
          "type": "boolean",
          "description": "Whether this field is hidden",
          "default": false
        },
        "position": {
          "type": "integer",
          "description": "Position of this field relative to other fields. Influences where it appears in the Jam Pad user interface.",
          "default": 1000
        },
        "showInListView": {
          "type": "boolean",
          "description": "Whether this field should show up in Jam Pad's list views (vs. only in the detail views).",
          "default": false
        },
        "name": {
          "type": "string",
          "description": "Field display name"
        },
        "description": {
          "type": "string",
          "description": "Explains the purpose of this field"
        },
        "type": {
          "enum": ["string", "note", "tonalQuality", "bpm", "timeSignature", "item", "items"],
          "description": "Defines which type of values this field accepts and how Jam Pad displays them"
        },
        "itemTypeId": {
          "type": "string",
          "description": "For type 'item' and 'items', this defines the collection of choices among which users may pick"
        }
      }
    },
    "CustomItemType": {
      "type": "object",
      "required": ["id", "name"],
      "title": "Custom item type",
      "description": "Defines a possible collection of items. The actual items for the collection are not yet defined.",
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string",
          "description": "Identifier of the custom item type. Must be unique within this space."
        },
        "hidden": {
          "type": "boolean",
          "description": "Whether this item collection is hidden",
          "default": false
        },
        "name": {
          "type": "string",
          "description": "Item collection name"
        }
      }
    },
    "CustomItem": {
      "type": "object",
      "required": ["id", "name"],
      "title": "Custom item",
      "description": "Defines an actual custom item belonging to the surrounding collection.",
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string",
          "description": "Identifier of the custom item. Must be unique within this collection."
        },
        "hidden": {
          "type": "boolean",
          "description": "Whether this item is hidden",
          "default": false
        },
        "name": {
          "type": "string",
          "description": "Item name"
        },
        "customColor": {
          "description": "Defines a custom color in which this item will be appear.",
          "$ref": "#/definitions/CustomColor"
        },
        "paletteColor": {
          "description": "Picks a color from a dynamic palette. Only applied if no custom color is given.",
          "type": "integer"
        }
      }
    },
    "CustomColor": {
      "title": "Custom color",
      "description": "Defines a custom RGB color",
      "type": "array",
      "items": [
        { "type": "integer", "minimum": 0, "maximum": 255, "description": "Amount of red" },
        { "type": "integer", "minimum": 0, "maximum": 255, "description": "Amount of green"  },
        { "type": "integer", "minimum": 0, "maximum": 255, "description": "Amount of blue"  }
      ],
      "minItems": 3,
      "maxItems": 3
    },
    "Clip": {
      "title": "Clip",
      "description": "Describes a clip",
      "type": "object",
      "required": ["id", "versions"],
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string",
          "description": "Identifier of the clip. Must be unique within this space."
        },
        "authorId": {
          "type": "integer",
          "description": "TODO"
        },
        "hidden": {
          "type": "boolean",
          "description": "Whether this clip is hidden",
          "default": false
        },
        "name": {
          "type": "string",
          "description": "Name of the clip",
          "default": "Metadata title or file name of the actually imported file"
        },
        "customData": {
          "$ref": "#/definitions/CustomData",
          "description": "Custom data associated with this clip"
        },
        "versions": {
          "type": "array",
          "minItems": 1,
          "items": {
            "$ref": "#/definitions/ClipVersion"
          },
          "description": "List of clip versions, starting at version 1"
        }
      }
    },
    "ClipVersion": {
      "title": "Clip version",
      "description": "Describes a particular version of a clip",
      "type": "object",
      "required": ["filePath"],
      "additionalProperties": false,
      "properties": {
        "filePath": {
          "type": "string",
          "description": "Path to the actual media file. This path must be relative to the directory in which the JSON file is located."
        },
        "recordedAt": {
          "$ref": "#/definitions/Timestamp",
          "description": "Certain timestamp that says when this clip version was initially recorded"
        },
        "origin": {
          "enum": ["imported", "recorded"],
          "description": "Whether this clip version was recorded directly within Jam Pad or imported from outside",
          "default": "imported"
        },
        "importInstallationId": {
          "type": "string",
          "format": "uuid",
          "description": "If imported, this field contains a globally unique identifier that says in which specific Jam Pad installation this clip version has been originally imported.",
          "default": "ID of the Jam Pad installation which is importing this JSON file"
        },
        "importId": {
          "type": "string",
          "format": "uuid",
          "description": "If imported, this field contains a globally unique identifier that says by which specific import job this clip version has been originally imported.",
          "default": "ID of the import with which this JSON file is being imported"
        },
        "importBaseFolderHash": {
          "type": "string",
          "description": "If imported, this field contains a cryptic string that says from which absolute base path the original import was started. It's cryptic for a reason: In collaborative spaces, this string will be visible to all space members. To protect the original importer's privacy, we don't save the base folder in plain text (it could contain an OS username)."
        },
        "importBaseFolderName": {
          "type": "string",
          "description": "If imported, this field contains the name of the folder from which the original import was started."
        },
        "importPath": {
          "type": "string",
          "description": "If imported, this field contains the relative path from which this media was originally imported.",
          "default": "Same as 'path'"
        },
        "importContentHash": {
          "type": "string",
          "description": "If imported, this field contains the unique fingerprint of the originally imported file.",
          "default": "Hash of the actual file that is being imported"
        },
        "importFormat": {
          "enum": ["wav", "mp3", "fac", "m4a"],
          "description": "If imported, this field contains the format of the originally imported file.",
          "default": "Format of the actual file that is being imported"
        }
      }
    },
    "Timestamp": {
      "type": "integer",
      "description": "Timezone-less timestamp, expressed in milliseconds since epoch UTC"
    },
    "Rating": {
      "type": "integer",
      "minimum": 2,
      "maximum": 5,
      "description": "A rating. Ratings in Jam Pad start at 2, not at 1. This makes marker button interactions more intuitive."
    },
    "CustomData": {
      "type": "object",
      "title": "Custom data",
      "description": "Arbitrary data. Each key of this object corresponds to the ID of a custom field. If the custom field doesn't exist, the data will be kept but not shown in the user interface. The structure of the value must correspond to the type of the custom field. It can be anything from a simple number to a complex nested object.",
      "additionalProperties": true
    },
    "Marker": {
      "title": "Marker",
      "description": "Describes a marker within a clip.",
      "type": "object",
      "required": ["id", "clipVersionId", "start"],
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string",
          "description": "Identifier of the marker. Must be unique within this space."
        },
        "authorId": {
          "type": "integer",
          "description": "TODO"
        },
        "hidden": {
          "type": "boolean",
          "description": "Whether this marker is hidden",
          "default": false
        },
        "clipVersionId": {
          "type": "string",
          "description": "ID of the clip version with which this marker is associated."
        },
        "name": {
          "type": "string",
          "description": "An optional marker name"
        },
        "start": {
          "type": "integer",
          "description": "Start position of the marker within the associated clip, in milliseconds."
        },
        "length": {
          "type": "integer",
          "description": "An optional marker length. If you provide this, the marker will not just mark a single point in time but a complete region of the clip. The length must be in milliseconds."
        },
        "rating": {
          "$ref": "#/definitions/Rating",
          "description": "An optional marker rating."
        },
        "createdAt": {
          "$ref": "#/definitions/Timestamp",
          "description": "Marker creation timestamp",
          "default": "Current time at import"
        },
        "comments": {
          "type": "array",
          "description": "Comments associated with this marker",
          "items": {
            "$ref": "#/definitions/Comment"
          }
        },
        "customData": {
          "$ref": "#/definitions/CustomData",
          "description": "Custom data associated with this marker"
        }
      }
    },
    "Comment": {
      "type": "object",
      "additionalProperties": false,
      "required": ["id", "content"],
      "title": "Comment",
      "description": "A comment that can be associated with a clip or marker",
      "properties": {
        "id": {
          "type": "string",
          "description": "Identifier of the comment. Must be unique within this space."
        },
        "authorId": {
          "type": "integer",
          "description": "TODO"
        },
        "hidden": {
          "type": "boolean",
          "description": "Whether this comment is hidden",
          "default": false
        },
        "createdAt": {
          "$ref": "#/definitions/Timestamp",
          "description": "Comment creation timestamp",
          "default": "Current time at import"
        },
        "content": {
          "type": "string",
          "description": "Comment text"
        }
      }
    },
    "Playlist": {
      "type": "object",
      "title": "Playlist",
      "description": "A playlist of clips and/or markers",
      "additionalProperties": false,
      "required": ["id", "name", "entries"],
      "properties": {
        "id": {
          "type": "string",
          "description": "Identifier of the playlist. Must be unique within this space."
        },
        "authorId": {
          "type": "integer",
          "description": "TODO"
        },
        "hidden": {
          "type": "boolean",
          "description": "Whether this playlist is hidden",
          "default": false
        },
        "createdAt": {
          "$ref": "#/definitions/Timestamp",
          "description": "Comment creation timestamp",
          "default": "Current time at import"
        },
        "name": {
          "type": "string",
          "description": "Playlist name"
        },
        "entries": {
          "type": "array",
          "description": "Playlist entries. Each entry must be a Jam Pad item reference followed by a '#' character and an ID uniquely identifying the entry itself. Check the examples!",
          "uniqueItems": true,
          "items": {
            "type": "string",
            "examples": [
              "/marker/019951e4-22aa-78e2-a8e8-4a36823d63aa#6DHP",
              "/clip/019951ef-5d9a-7a48-bbb9-23d7d9c5f4fc#TYCX"
            ]
          }
        }
      }
    },
    "Sheet": {
      "type": "object",
      "title": "Sheet",
      "description": "A simple document that can embed Jam Pad items such as clips or markers",
      "required": ["id", "content"],
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string",
          "description": "Identifier of the sheet. Must be unique within this space."
        },
        "hidden": {
          "type": "boolean",
          "description": "Whether this marker is hidden",
          "default": false
        },
        "title": {
          "type": "string",
          "description": "Sheet title",
          "default": "Same like ID"
        },
        "content": {
          "$ref": "#/definitions/SheetContent",
          "description": "Sheet content"
        }
      }
    },
    "SheetContent": {
      "type": "object",
      "title": "SheetContent",
      "additionalProperties": true,
      "description": "TODO"
    }
  }
}
